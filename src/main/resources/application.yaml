spring:
  profiles:
    active:
      - dev
  datasource:
    url: ${POSTGRES_URI}:${POSTGRES_PORT}/${POSTGRES_DB}
    username: ${POSTGRES_USER}
    password: ${POSTGRES_PASSWORD}
  docker:
    compose:
      lifecycle-management: START_AND_STOP
      stop:
        command: down
        arguments: --volumes --remove-orphans
      skip:
        in-tests: true
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        ddl-auto: create-drop
        format_sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect
    open-in-view: false
  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}
  elasticsearch:
    uris: ${ELASTICSEARCH_HOSTS}
    username: ${ELASTICSEARCH_USERNAME}
    password: ${ELASTIC_PASSWORD}
  jackson:
    serialization:
      write-dates-as-timestamps: false
  rabbitmq:
    host: ${RABBITMQ_HOST:localhost}
    port: ${RABBITMQ_PORT:5672}
    username: ${RABBITMQ_USERNAME:guest}
    password: ${RABBITMQ_PASSWORD:guest}

logging:
  pattern:
    level: "%5p [trace=%X{traceId}]"
  audit:
    enabled: true
    async: true
    retention-days: 365
  application:
    enabled: true
    async: true
    elasticsearch:
      index-pattern: "application-logs-{yyyy.MM}"
      retention-days: 90

management:
  endpoints:
    web:
      exposure:
        include: health,info

application:
  security:
    jwt-secret: ${JWT_SECRET}
    access-token-ttl: PT15M
    refresh-token-ttl: P7D
    email-verification-token-ttl: PT24H
    password-reset-token-ttl: PT1H
    public-endpoints:
      - /actuator/**
      - /swagger-ui/**
      - /v3/api-docs/**
      - /api/v1/auth/**
  rate-limit:
    capacity: 100
    refill-period: PT1M
  storage:
    s3:
      bucket: ${AWS_S3_BUCKET}
      region: ${AWS_S3_REGION}
      access-key: ${AWS_ACCESS_KEY_ID}
      secret-key: ${AWS_SECRET_ACCESS_KEY}
      endpoint: ${AWS_S3_ENDPOINT}
      path-style-access: false
      public-base-url: ${AWS_S3_PUBLIC_URL}
  rabbitmq:
    exchange: notifications.exchange
    routing-key: notifications.new
